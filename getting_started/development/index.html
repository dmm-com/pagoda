<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Development"><title>Development | Pagoda</title><link rel=icon href=https://dmm-com.github.io/pagoda/favicon/favicon-32x32.png type=image/x-icon><link rel=preload as=font href=https://dmm-com.github.io/pagoda/fonts/Metropolis.woff2 type=font/woff2 crossorigin=anonymous><link rel=preload as=font href=https://dmm-com.github.io/pagoda/fonts/LiberationSans.woff2 type=font/woff2 crossorigin=anonymous><link rel=preload as=font href=https://dmm-com.github.io/pagoda/fonts/LiberationSans-Bold.woff2 type=font/woff2 crossorigin=anonymous><link rel=preload as=font href=https://dmm-com.github.io/pagoda/fonts/LiberationSans-BoldItalic.woff2 type=font/woff2 crossorigin=anonymous><link rel=preload as=font href=https://dmm-com.github.io/pagoda/fonts/LiberationSans-Italic.woff2 type=font/woff2 crossorigin=anonymous><link rel=preload as=font href=https://dmm-com.github.io/pagoda/fonts/LiberationMono.woff2 type=font/woff2 crossorigin=anonymous><link rel=preload as=font href=https://dmm-com.github.io/pagoda/fonts/DroidSans.woff2 type=font/woff2 crossorigin=anonymous><link rel=preload as=font href=https://dmm-com.github.io/pagoda/fonts/GeekdocIcons.woff2 type=font/woff2 crossorigin=anonymous><link rel=preload href=https://dmm-com.github.io/pagoda/main.min.css as=style><link rel=stylesheet href=https://dmm-com.github.io/pagoda/main.min.css media=all><link rel=preload href=https://dmm-com.github.io/pagoda/mobile.min.css as=style><link rel=stylesheet href=https://dmm-com.github.io/pagoda/mobile.min.css media="screen and (max-width: 45rem)"><link rel=preload href=https://dmm-com.github.io/pagoda/print.min.css as=style><link rel=stylesheet href=https://dmm-com.github.io/pagoda/print.min.css media=print><link rel=preload href=https://dmm-com.github.io/pagoda/custom.css as=style><link rel=stylesheet href=https://dmm-com.github.io/pagoda/custom.css media=all></head><body><svg style="position:absolute;width:0;height:0;overflow:hidden" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><symbol viewBox="-2.67 -2.67 29.33 29.33" id="arrow_back" xmlns="http://www.w3.org/2000/svg"><path d="M24 10.526v2.947H5.755l8.351 8.421-2.105 2.105-12-12 12-12 2.105 2.105-8.351 8.421H24z"/></symbol><symbol viewBox="-2.67 -2.67 29.33 29.33" id="arrow_left_alt" xmlns="http://www.w3.org/2000/svg"><path d="M5.965 10.526V6.035L0 12l5.965 5.965v-4.491H24v-2.947H5.965z"/></symbol><symbol viewBox="-2.67 -2.67 29.33 29.33" id="arrow_right_alt" xmlns="http://www.w3.org/2000/svg"><path d="M18.035 10.526V6.035L24 12l-5.965 5.965v-4.491H0v-2.947h18.035z"/></symbol><symbol viewBox="-2.67 -2.67 29.33 29.33" id="bookmark" xmlns="http://www.w3.org/2000/svg"><path d="M15.268 4.392q.868.0 1.532.638t.664 1.506v17.463l-7.659-3.268-7.608 3.268V6.536q0-.868.664-1.506t1.532-.638h10.876zm4.34 14.144V4.392q0-.868-.638-1.532t-1.506-.664H6.537q0-.868.664-1.532T8.733.0h10.876q.868.0 1.532.664t.664 1.532v17.412z"/></symbol><symbol viewBox="-2.67 -2.67 33.33 33.33" id="code" xmlns="http://www.w3.org/2000/svg"><path d="M9.917 24.5a1.75 1.75.0 10-3.501.001 1.75 1.75.0 003.501-.001zm0-21a1.75 1.75.0 10-3.501.001A1.75 1.75.0 009.917 3.5zm11.666 2.333a1.75 1.75.0 10-3.501.001 1.75 1.75.0 003.501-.001zm1.75.0a3.502 3.502.0 01-1.75 3.026c-.055 6.581-4.721 8.039-7.82 9.023-2.898.911-3.846 1.349-3.846 3.117v.474a3.502 3.502.0 011.75 3.026c0 1.932-1.568 3.5-3.5 3.5s-3.5-1.568-3.5-3.5c0-1.294.711-2.424 1.75-3.026V6.526A3.502 3.502.0 014.667 3.5c0-1.932 1.568-3.5 3.5-3.5s3.5 1.568 3.5 3.5a3.502 3.502.0 01-1.75 3.026v9.06c.93-.456 1.914-.766 2.807-1.039 3.391-1.075 5.323-1.878 5.359-5.687a3.502 3.502.0 01-1.75-3.026c0-1.932 1.568-3.5 3.5-3.5s3.5 1.568 3.5 3.5z"/></symbol><symbol viewBox="-2.67 -2.67 37.33 37.33" id="date" xmlns="http://www.w3.org/2000/svg"><path d="M27.192 28.844V11.192H4.808v17.652h22.384zm0-25.689q1.277.0 2.253.976t.976 2.253v22.459q0 1.277-.976 2.216t-2.253.939H4.808q-1.352.0-2.291-.901t-.939-2.253V6.385q0-1.277.939-2.253t2.291-.976h1.577V.001h3.23v3.155h12.769V.001h3.23v3.155h1.577zm-3.155 11.267v3.155h-3.23v-3.155h3.23zm-6.46.0v3.155h-3.155v-3.155h3.155zm-6.384.0v3.155h-3.23v-3.155h3.23z"/></symbol><symbol viewBox="-2.67 -2.67 37.33 37.33" id="download" xmlns="http://www.w3.org/2000/svg"><path d="M2.866 28.209h26.269v3.79H2.866v-3.79zm26.268-16.925L16 24.418 2.866 11.284h7.493V.001h11.283v11.283h7.493z"/></symbol><symbol viewBox="-2.67 -2.67 37.33 37.33" id="email" xmlns="http://www.w3.org/2000/svg"><path d="M28.845 9.615v-3.23L16 14.422 3.155 6.385v3.23L16 17.577zm0-6.46q1.277.0 2.216.977T32 6.385v19.23q0 1.277-.939 2.253t-2.216.977H3.155q-1.277.0-2.216-.977T0 25.615V6.385q0-1.277.939-2.253t2.216-.977h25.69z"/></symbol><symbol viewBox="-2.67 -2.67 37.33 37.33" id="github" xmlns="http://www.w3.org/2000/svg"><path d="M16 .394c8.833.0 15.999 7.166 15.999 15.999.0 7.062-4.583 13.062-10.937 15.187-.813.146-1.104-.354-1.104-.771.0-.521.021-2.25.021-4.396.0-1.5-.5-2.458-1.083-2.958 3.562-.396 7.312-1.75 7.312-7.896.0-1.75-.625-3.167-1.646-4.291.167-.417.708-2.042-.167-4.25-1.333-.417-4.396 1.646-4.396 1.646a15.032 15.032.0 00-8 0S8.937 6.602 7.603 7.018c-.875 2.208-.333 3.833-.167 4.25-1.021 1.125-1.646 2.542-1.646 4.291.0 6.125 3.729 7.5 7.291 7.896-.458.417-.875 1.125-1.021 2.146-.917.417-3.25 1.125-4.646-1.333-.875-1.521-2.458-1.646-2.458-1.646-1.562-.021-.104.979-.104.979 1.042.479 1.771 2.333 1.771 2.333.938 2.854 5.396 1.896 5.396 1.896.0 1.333.021 2.583.021 2.979.0.417-.292.917-1.104.771C4.582 29.455-.001 23.455-.001 16.393-.001 7.56 7.165.394 15.998.394zM6.063 23.372c.042-.083-.021-.187-.146-.25-.125-.042-.229-.021-.271.042-.042.083.021.187.146.25.104.062.229.042.271-.042zm.646.709c.083-.062.062-.208-.042-.333-.104-.104-.25-.146-.333-.062-.083.062-.062.208.042.333.104.104.25.146.333.062zm.625.937c.104-.083.104-.25.0-.396-.083-.146-.25-.208-.354-.125-.104.062-.104.229.0.375s.271.208.354.146zm.875.875c.083-.083.042-.271-.083-.396-.146-.146-.333-.167-.417-.062-.104.083-.062.271.083.396.146.146.333.167.417.062zm1.187.521c.042-.125-.083-.271-.271-.333-.167-.042-.354.021-.396.146s.083.271.271.312c.167.062.354.0.396-.125zm1.313.104c0-.146-.167-.25-.354-.229-.187.0-.333.104-.333.229.0.146.146.25.354.229.187.0.333-.104.333-.229zm1.208-.208c-.021-.125-.187-.208-.375-.187-.187.042-.312.167-.292.312.021.125.187.208.375.167s.312-.167.292-.292z"/></symbol><symbol viewBox="-2.67 -2.67 37.33 37.33" id="heart" xmlns="http://www.w3.org/2000/svg"><path d="M16 29.714a1.11 1.11.0 01-.786-.321L4.072 18.643c-.143-.125-4.071-3.714-4.071-8 0-5.232 3.196-8.357 8.535-8.357 3.125.0 6.053 2.464 7.464 3.857 1.411-1.393 4.339-3.857 7.464-3.857 5.339.0 8.535 3.125 8.535 8.357.0 4.286-3.928 7.875-4.089 8.035L16.785 29.392c-.214.214-.5.321-.786.321z"/></symbol><symbol viewBox="-2.67 -2.67 33.33 33.33" id="keyborad_arrow_down" xmlns="http://www.w3.org/2000/svg"><path d="M3.281 5.36 14 16.079 24.719 5.36 28 8.641l-14 14-14-14z"/></symbol><symbol viewBox="-2.67 -2.67 37.33 37.33" id="keyborad_arrow_left" xmlns="http://www.w3.org/2000/svg"><path d="M25.875 28.25 22.125 32 6.126 16.001 22.125.002l3.75 3.75-12.25 12.25z"/></symbol><symbol viewBox="-2.67 -2.67 37.33 37.33" id="keyborad_arrow_right" xmlns="http://www.w3.org/2000/svg"><path d="M6.125 28.25 18.375 16 6.125 3.75 9.875.0l15.999 15.999L9.875 31.998z"/></symbol><symbol viewBox="-2.67 -2.67 37.33 37.33" id="link" xmlns="http://www.w3.org/2000/svg"><path d="M24.037 7.963q3.305.0 5.634 2.366T32 16t-2.329 5.671-5.634 2.366h-6.46v-3.08h6.46q2.028.0 3.493-1.465t1.465-3.493-1.465-3.493-3.493-1.465h-6.46v-3.08h6.46zM9.615 17.578v-3.155h12.77v3.155H9.615zM3.005 16q0 2.028 1.465 3.493t3.493 1.465h6.46v3.08h-6.46q-3.305.0-5.634-2.366T0 16.001t2.329-5.671 5.634-2.366h6.46v3.08h-6.46q-2.028.0-3.493 1.465t-1.465 3.493z"/></symbol><symbol viewBox="-2.67 -2.67 37.33 37.33" id="menu" xmlns="http://www.w3.org/2000/svg"><path d="M.001 5.334h31.998v3.583H.001V5.334zm0 12.416v-3.5h31.998v3.5H.001zm0 8.916v-3.583h31.998v3.583H.001z"/></symbol><symbol viewBox="-2.67 -2.67 33.33 33.33" id="notification" xmlns="http://www.w3.org/2000/svg"><path d="M22.615 19.384l2.894 2.894v1.413H2.49v-1.413l2.894-2.894V12.25q0-3.365 1.716-5.856t4.745-3.231v-1.01q0-.875.606-1.514T13.999.0t1.548.639.606 1.514v1.01q3.029.74 4.745 3.231t1.716 5.856v7.134zM14 27.999q-1.211.0-2.053-.808t-.841-2.019h5.788q0 1.144-.875 1.986T14 27.999z"/></symbol><symbol viewBox="-2.67 -2.67 33.33 33.33" id="path" xmlns="http://www.w3.org/2000/svg"><path d="M28 12.62h-9.793V8.414h-2.826v11.173h2.826v-4.206H28V26.62h-9.793v-4.206H12.62v-14H9.794v4.206H.001V1.381h9.793v4.206h8.413V1.381H28V12.62z"/></symbol><symbol viewBox="-2.67 -2.67 37.33 37.33" id="person" xmlns="http://www.w3.org/2000/svg"><path d="M16 20.023q5.052.0 10.526 2.199t5.473 5.754v4.023H0v-4.023q0-3.555 5.473-5.754t10.526-2.199zM16 16q-3.275.0-5.614-2.339T8.047 8.047t2.339-5.661T16 0t5.614 2.386 2.339 5.661-2.339 5.614T16 16z"/></symbol><symbol viewBox="-2.67 -2.67 37.33 37.33" id="search" xmlns="http://www.w3.org/2000/svg"><path d="M11.925 20.161q3.432.0 5.834-2.402t2.402-5.834-2.402-5.834-5.834-2.402-5.834 2.402-2.402 5.834 2.402 5.834 5.834 2.402zm10.981.0L32 29.255 29.255 32l-9.094-9.094v-1.458l-.515-.515q-3.26 2.831-7.721 2.831-4.976.0-8.45-3.432T.001 11.925t3.474-8.45 8.45-3.474 8.407 3.474 3.432 8.45q0 1.802-.858 4.075t-1.973 3.646l.515.515h1.458z"/></symbol><symbol viewBox="-2.67 -2.67 33.33 33.33" id="shield" xmlns="http://www.w3.org/2000/svg"><path d="M22.167 15.166V3.5h-8.166v20.726c.93-.492 2.424-1.349 3.883-2.497 1.95-1.531 4.284-3.919 4.284-6.562zm3.499-13.999v14c0 7.674-10.737 12.523-11.192 12.724-.146.073-.31.109-.474.109s-.328-.036-.474-.109c-.456-.201-11.192-5.049-11.192-12.724v-14C2.334.529 2.863.0 3.501.0H24.5c.638.0 1.167.529 1.167 1.167z"/></symbol><symbol viewBox="-2.67 -2.67 33.33 33.33" id="tags" xmlns="http://www.w3.org/2000/svg"><path d="M6.606 7.549c0-1.047-.84-1.887-1.887-1.887s-1.887.84-1.887 1.887.84 1.887 1.887 1.887 1.887-.84 1.887-1.887zm15.732 8.493c0 .501-.206.988-.546 1.327l-7.239 7.254c-.354.339-.84.546-1.342.546s-.988-.206-1.327-.546L1.342 14.066C.59 13.329.0 11.899.0 10.852V4.718a1.9 1.9.0 011.887-1.887h6.134c1.047.0 2.477.59 3.229 1.342L21.792 14.7c.339.354.546.84.546 1.342zm5.661.0c0 .501-.206.988-.546 1.327l-7.239 7.254c-.354.339-.84.546-1.342.546-.767.0-1.15-.354-1.651-.87l6.93-6.93c.339-.339.546-.826.546-1.327s-.206-.988-.546-1.342L13.609 4.173c-.752-.752-2.182-1.342-3.229-1.342h3.303c1.047.0 2.477.59 3.229 1.342L27.454 14.7c.339.354.546.84.546 1.342z"/></symbol><symbol viewBox="-2.67 -2.67 37.33 37.33" id="telescope" xmlns="http://www.w3.org/2000/svg"><path d="M25.026 3.335a.466.466.0 00-.646-.238L13.362 8.91a.463.463.0 00-.216.575l.227.593-6.36 3.488a.462.462.0 00-.205.583l.211.508-6.755 3.228a.463.463.0 00-.228.595l1.386 3.341a.463.463.0 00.583.259l7.056-2.5.211.508a.462.462.0 00.557.267l6.733-1.941.202.527a.46.46.0 00.566.277l12.03-3.702a.46.46.0 00.293-.613L25.026 3.335zM2.109 21.061l-1.049-2.53 6.314-3.018 1.332 3.211-6.596 2.337zm7.857-1.708-.22-.531-1.706-4.113-.22-.53 5.863-3.216 2.197 5.676.347.908-6.261 1.806zm7.505-1.146-.188-.491c-.003-.01-.001-.022-.006-.032l-.572-1.478-2.549-6.668 10.201-5.381 4.249 10.624-11.136 3.428zm8.943-16.723a.463.463.0 00-.86.344l5.552 13.881a.464.464.0 00.602.258.464.464.0 00.258-.602L26.413 1.484zM16.268 20.627h-2.776c-1.055.0-1.851.796-1.851 1.851v1.217l-5.44 6.347a.462.462.0 10.702.602l5.415-6.316h2.101v6.015a.463.463.0 00.926.0v-6.015h2.101l5.414 6.316a.462.462.0 10.703-.602l-5.44-6.347v-1.148c0-1.076-.813-1.92-1.851-1.92zm.925 2.777h-4.627v-.925c0-.545.38-.925.925-.925h2.776c.527.0.925.428.925.995v.856z"/></symbol></svg><div class=wrapper><input type=checkbox class=hidden id=menu-control><header class=gdoc-header><div class="container flex align-center justify-between"><label for=menu-control class=gdoc-nav__control><svg class="icon menu"><use xlink:href="#menu"/></svg><svg class="icon arrow-back"><use xlink:href="#arrow_back"/></svg></label><a class=gdoc-header__link href=https://dmm-com.github.io/pagoda/><span class="gdoc-brand flex align-center"><img class=gdoc-brand__img src=https://dmm-com.github.io/pagoda/media/logo.png alt width=38 height=38>
Pagoda</span></a></div></header><main class="container flex flex-even"><aside class=gdoc-nav><nav><div class=gdoc-search><svg class="icon search"><use xlink:href="#search"/></svg><input type=text id=gdoc-search-input class=gdoc-search__input placeholder=Search... aria-label=Search maxlength=64><div class="gdoc-search__spinner spinner hidden"></div><ul id=gdoc-search-results class=gdoc-search__list></ul></div><section class=gdoc-nav--main><h2>Navigation</h2><ul class=gdoc-nav__list><li><span class=flex>Getting Started</span><ul class=gdoc-nav__list><li><span class=flex><a href=https://dmm-com.github.io/pagoda/getting_started/overview/ class=gdoc-nav__entry>Pagoda Overview</a></span></li><li><span class=flex><a href=https://dmm-com.github.io/pagoda/getting_started/installation/ class=gdoc-nav__entry>Installation and Configuration</a></span></li><li><span class=flex><a href=https://dmm-com.github.io/pagoda/getting_started/tutorial/ class=gdoc-nav__entry>Tutorial</a></span></li><li><span class=flex><a href=https://dmm-com.github.io/pagoda/getting_started/development/ class="gdoc-nav__entry is-active">Development</a></span></li></ul></li><li><span class=flex>Advanced Topics</span><ul class=gdoc-nav__list><li><span class=flex><a href=https://dmm-com.github.io/pagoda/advanced/advanced_search/ class=gdoc-nav__entry>Advanced Search</a></span></li><li><span class=flex><a href=https://dmm-com.github.io/pagoda/advanced/frontend/ class=gdoc-nav__entry>Frontend</a></span></li><li><span class=flex><a href=https://dmm-com.github.io/pagoda/advanced/custom_view/ class=gdoc-nav__entry>CustomView</a></span></li></ul></li><li><span class=flex>Release Notes</span><ul class=gdoc-nav__list><li><span class=flex><a href=https://dmm-com.github.io/pagoda/release_note/CHANGELOG/ class=gdoc-nav__entry>Changelog</a></span></li></ul></li></ul></section><section class=gdoc-nav--more><h2>More</h2><ul class=gdoc-nav__list><li><span class=flex><svg class="icon notification"><use xlink:href="#notification"/></svg><a href=https://dmm-com.github.io/pagoda/posts/ class=gdoc-nav__entry>News</a></span></li><li><span class=flex><svg class="icon download"><use xlink:href="#download"/></svg><a href=https://github.com/dmm-com/pagoda/releases class=gdoc-nav__entry>Releases</a></span></li><li><span class=flex><svg class="icon github"><use xlink:href="#github"/></svg><a href=https://github.com/dmm-com/pagoda class=gdoc-nav__entry>View Source</a></span></li></ul></section></nav></aside><div class=gdoc-page><div class="gdoc-page__header flex flex-wrap justify-between hidden-mobile" itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span><span class=breadcrumb><svg class="icon path"><use xlink:href="#path"/></svg><a href=https://dmm-com.github.io/pagoda/>Pagoda</a> / <a href=https://dmm-com.github.io/pagoda/getting_started/>Getting Started</a> / Development</span></span>
<span></span></div><article class=gdoc-markdown><h1>Development</h1><h1 id=setup>Setup</h1><p>Here is the documentation to setup the development environment of Pagoda.</p><div class=gdoc-page__anchorwrap><h2 id=installation-of-pagoda>Installation of Pagoda<a data-clipboard-text=https://dmm-com.github.io/pagoda/getting_started/development/#installation-of-pagoda class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor Installation of Pagoda" href=#installation-of-pagoda><svg class="icon link"><use xlink:href="#link"/></svg></a></h2></div><p>You have to install Python3.11+ to run Pagoda like below (for the case of <code>ubuntu</code>).</p><pre tabindex=0><code>user@hostname:~$ sudo apt-get update
user@hostname:~$ sudo apt-get install python3 python3-pip python3-venv
</code></pre><p>You have to install libraries.</p><pre tabindex=0><code>user@hostname:~$ sudo apt-get install libldap2-dev  libsasl2-dev libxmlsec1-dev libmysqlclient-dev pkg-config
</code></pre><p>(for macOS)</p><pre tabindex=0><code>user@hostname:~$ brew install libxmlsec1 mysql-client pkg-config mysql-connector-python
</code></pre><p>Then, you can install libraries on which Pagoda depends by following after cloning this repository. But we recommand you to setup pagoda on the separated environment using virtualenv not to pollute system-wide python environment.</p><pre tabindex=0><code>user@hostname:~$ git clone https://github.com/dmm-com/pagoda.git
user@hostname:~$ cd pagoda
user@hostname:~/pagoda$ python3 -m venv virtualenv
user@hostname:~/pagoda$ source virtualenv/bin/activate
(virtualenv) user@hostname:~/pagoda$ pip install pip --upgrade
(virtualenv) user@hostname:~/pagoda$ pip install poetry
(virtualenv) user@hostname:~/pagoda$ poetry install --only main
# or, during development, install all
(virtualenv) user@hostname:~/pagoda$ poetry install
</code></pre><div class=gdoc-page__anchorwrap><h2 id=setting-up-backend-with-docker-compose>Setting-up Backend with docker-compose<a data-clipboard-text=https://dmm-com.github.io/pagoda/getting_started/development/#setting-up-backend-with-docker-compose class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor Setting-up Backend with docker-compose" href=#setting-up-backend-with-docker-compose><svg class="icon link"><use xlink:href="#link"/></svg></a></h2></div><p>Install docker-compose command.<br>Run middlewares with docker-compose.</p><pre tabindex=0><code>user@hostname:~/pagoda$ docker-compose up
</code></pre><div class=gdoc-page__anchorwrap><h2 id=setting-up-backend-with-manual>(Setting-up Backend with manual)<a data-clipboard-text=https://dmm-com.github.io/pagoda/getting_started/development/#setting-up-backend-with-manual class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor (Setting-up Backend with manual)" href=#setting-up-backend-with-manual><svg class="icon link"><use xlink:href="#link"/></svg></a></h2></div><p>And you have to install RabbitMQ for executing heavy processing as background task using <a href=http://docs.celeryproject.org/>Celery</a>.</p><pre tabindex=0><code>user@hostname:~$ sudo apt-get install rabbitmq-server mysql-server python-dev libmysqlclient-dev
</code></pre><div class=gdoc-page__anchorwrap><h3 id=setting-up-mysql-configuration>Setting-up MySQL configuration<a data-clipboard-text=https://dmm-com.github.io/pagoda/getting_started/development/#setting-up-mysql-configuration class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor Setting-up MySQL configuration" href=#setting-up-mysql-configuration><svg class="icon link"><use xlink:href="#link"/></svg></a></h3></div><p>Specifying character set of database is necessary. Please add following setting in the <code>mysqld.cnf</code> at <code>mysqld</code> section.</p><pre tabindex=0><code>[mysqld]
...
character-set-server = utf8mb4
</code></pre><p>Then, you should restart MySQL server to apply for this configuration.</p><pre tabindex=0><code>user@hostname:~$ sudo service mysql restart
</code></pre><p>Iincrease the number of Slave databases with the MySQL replication function.<br>You can set database slave, with like this config:</p><pre tabindex=0><code>REPLICATED_DATABASE_SLAVES = [&#39;slave1&#39;, &#39;slave2&#39;]
</code></pre><div class=gdoc-page__anchorwrap><h3 id=setting-up-elasticsearch>Setting-up Elasticsearch<a data-clipboard-text=https://dmm-com.github.io/pagoda/getting_started/development/#setting-up-elasticsearch class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor Setting-up Elasticsearch" href=#setting-up-elasticsearch><svg class="icon link"><use xlink:href="#link"/></svg></a></h3></div><p>You have to setup JRE for executing elasticsearch.</p><pre tabindex=0><code>user@hostname:~$ sudo add-apt-repository ppa:linuxuprising/java
user@hostname:~$ sudo apt-get update
user@hostname:~$ sudo apt-get install -y oracle-java13-installer
</code></pre><p>The way to install elasticsearch is quite easy like that.</p><pre tabindex=0><code>user@hostname:~$ wget https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-7.17.6-linux-x86_64.tar.gz
user@hostname:~$ tar -xvf elasticsearch-7.17.6-linux-x86_64.tar.gz
</code></pre><p>After installing it, you have to change configuration to accept connecting from Pagoda nodes.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-diff data-lang=diff><span class=line><span class=cl><span class=gd>--- elasticsearch-7.17.6-linux-x86_64/config/elasticsearch.yml.old        2020-01-29 10:19:40.511687943 +0900
</span></span></span><span class=line><span class=cl><span class=gd></span><span class=gi>+++ elasticsearch-7.17.6-linux-x86_64/config/elasticsearch.yml            2020-01-29 10:41:23.103687943 +0900
</span></span></span><span class=line><span class=cl><span class=gi></span><span class=gu>@@ -52,7 +52,7 @@
</span></span></span><span class=line><span class=cl><span class=gu></span> #
</span></span><span class=line><span class=cl> # Set the bind address to a specific IP (IPv4 or IPv6):
</span></span><span class=line><span class=cl> #
</span></span><span class=line><span class=cl><span class=gd>-#network.host: 192.168.0.1
</span></span></span><span class=line><span class=cl><span class=gd></span><span class=gi>+network.host: 0.0.0.0
</span></span></span><span class=line><span class=cl><span class=gi></span> #
</span></span><span class=line><span class=cl> # Set a custom port for HTTP:
</span></span><span class=line><span class=cl> #
</span></span></code></pre></div><p>You should set sysctl as below because Elasticsearch requires to expand virtual memory area.</p><pre tabindex=0><code>user@hostname:~$ sudo sysctl vm.max_map_count=262144
</code></pre><p>Finally, you can run ElasticSearch service like that.</p><pre tabindex=0><code>user@hostname:~$ elasticsearch-7.17.6-linux-x86_64/bin/elasticsearch
</code></pre><div class=gdoc-page__anchorwrap><h3 id=setting-up-email-configuration>Setting-up Email configuration<a data-clipboard-text=https://dmm-com.github.io/pagoda/getting_started/development/#setting-up-email-configuration class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor Setting-up Email configuration" href=#setting-up-email-configuration><svg class="icon link"><use xlink:href="#link"/></svg></a></h3></div><p>This step is optional. You can skip it if you don&rsquo;t use email notifications.</p><p>Pagoda supports email based notification, now it&rsquo;s mainly used for password-reset. You can set email backend, with like this config:</p><pre tabindex=0><code>EMAIL_BACKEND = &#39;django.core.mail.backends.smtp.EmailBackend&#39;
EMAIL_HOST = &#39;xxx&#39;
EMAIL_PORT = 25
EMAIL_HOST_USER = &#39;xxx&#39;
EMAIL_HOST_PASSWORD = &#39;xxx&#39;
EMAIL_USE_TLS = True
</code></pre><p>If you hope to just try it in your local environment, you can use stdout instead:</p><pre tabindex=0><code>EMAIL_BACKEND = &#39;django.core.mail.backends.console.EmailBackend&#39;
</code></pre><div class=gdoc-page__anchorwrap><h2 id=setting-up-nginx-optional>Setting-up Nginx (Optional)<a data-clipboard-text=https://dmm-com.github.io/pagoda/getting_started/development/#setting-up-nginx-optional class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor Setting-up Nginx (Optional)" href=#setting-up-nginx-optional><svg class="icon link"><use xlink:href="#link"/></svg></a></h2></div><p>Install Nginx by package manager like this.</p><pre tabindex=0><code>user@hostname:~$ sudo apt-get install nginx
</code></pre><p>Create Self-Signed SSL Certificate and key-pair.</p><pre tabindex=0><code>user@hostname:~$ openssl genrsa 2048 &gt; server.key
user@hostname:~$ openssl req -new -key server.key &gt; server.csr
... (set appropriate configuration)

user@hostname:~$ openssl x509 -days 3650 -req -signkey server.key &lt; server.csr &gt; server.crt
user@hostname:~$ sudo mkdir /etc/nginx/ssl
user@hostname:~$ sudo mv server* /etc/nginx/ssl
</code></pre><p>Write following configuration for Pagoda on Nginx at <code>/etc/nginx/conf.d/pagoda.conf</code>.</p><pre tabindex=0><code>upstream pagoda {
  server hostname:8080;
}

server {
  listen 443 ssl;

  ssl_certificate /etc/nginx/ssl/server.crt;
  ssl_certificate_key /etc/nginx/ssl/server.key;

  proxy_set_header    Host    $host;
  proxy_set_header    X-Real-IP    $remote_addr;
  proxy_set_header    X-Forwarded-Host    $host;
  proxy_set_header    X-Forwarded-Server    $host;
  proxy_set_header    X-Forwarded-For    $proxy_add_x_forwarded_for;
  proxy_set_header    X-Forwarded-Proto    $scheme;
  proxy_set_header    X-Forwarded-Port    443;

  location / {
    rewrite ^/(.*) /$1 break;

    proxy_pass    http://pagoda/;
  }

  access_log /var/log/nginx/pagoda.ssl.access.log combined;
  error_log /var/log/nginx/pagoda.ssl.error.log;

  # set longer to wait background processing until 300s
  proxy_read_timeout 300;
}
</code></pre><p>This includes the configuration to proxy HTTP request to Pagoda and cache static files. The static file path indicates the static directory which is in the top of Pagoda local repository. If necessary, please fix this value depending on your environment.</p><div class=gdoc-page__anchorwrap><h2 id=initialize-pagoda-configuratoin>Initialize Pagoda configuratoin<a data-clipboard-text=https://dmm-com.github.io/pagoda/getting_started/development/#initialize-pagoda-configuratoin class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor Initialize Pagoda configuratoin" href=#initialize-pagoda-configuratoin><svg class="icon link"><use xlink:href="#link"/></svg></a></h2></div><p>You should create user and attach role in Elasticsearch.</p><pre tabindex=0><code>bin/elasticsearch-users useradd airone
bin/elasticsearch-users roles airone --add superuser
</code></pre><p>You should cerate database and user for pagoda in MySQL.</p><pre tabindex=0><code>user@hostname:~$ mysql -u root -h 127.0.0.1

mysql&gt; create database airone;
mysql&gt; create database test_airone;
mysql&gt; CREATE USER &#39;airone&#39;@&#39;%&#39; IDENTIFIED BY &#39;password&#39;;
mysql&gt; GRANT ALL ON airone.* to airone@&#39;%&#39;;
mysql&gt; GRANT ALL ON test_airone.* to airone@&#39;%&#39;;
</code></pre><p>This command makes database schema using the <a href=https://docs.djangoproject.com/en/1.11/topics/migrations/>django Migrations</a>, and makes default user account.</p><pre tabindex=0><code>user@hostname:~$ cd pagoda
user@hostname:~/pagoda$ source virtualenv/bin/activate
(virtualenv) user@hostname:~/pagoda$ tools/clear_and_initdb.sh
</code></pre><p>(Optional) Please set the index as necessary.</p><pre tabindex=0><code>mysql&gt; CREATE INDEX permission_codename_idx ON auth_permission (codename);
</code></pre><p>Finally, you should create an initial user to login the system using <code>tools/register_user.sh</code>.</p><pre tabindex=0><code>(virtualenv) user@hostname:~/pagoda$ tools/register_user.sh demo
Password:   ## input password of this user
Succeed in register user (demo)
</code></pre><p>This creates following user.</p><table><thead><tr><th style=text-align:left>Username</th><th style=text-align:left>Password</th></tr></thead><tbody><tr><td style=text-align:left>demo</td><td style=text-align:left>demo</td></tr></tbody></table><p>If you want to create an administrative user who can access all information regardless of ACL (Please refer the <a href=#>User-Manual(TBD)</a>), you can do it with <code>-s, --superuser</code> option. This creates another user who takes privilege of this system.</p><pre tabindex=0><code>(virtualenv) user@hostname:~/pagoda$ tools/register_user.sh -s admin
Password:   ## input password of this user
Succeed in register user (admin)
</code></pre><p>This regists all entries which has been created in the database to the Elasticsearch.<br>You can do it just by following command. The configurations about the database to read and Elasticsearch to register are referred from airone/settings.py.</p><pre tabindex=0><code>(virtualenv) user@hostname:~/pagoda$ python tools/initialize_es_document.py
</code></pre><div class=gdoc-page__anchorwrap><h2 id=run-pagoda>Run Pagoda<a data-clipboard-text=https://dmm-com.github.io/pagoda/getting_started/development/#run-pagoda class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor Run Pagoda" href=#run-pagoda><svg class="icon link"><use xlink:href="#link"/></svg></a></h2></div><p>You can start Pagoda as following and can browse from <code>http://hostname:8080/</code><br>(Please change the <code>hostname</code> to the appropriate one on which you installed Pagoda).
e.g.</p><pre tabindex=0><code>user@hostname:~$ cd pagoda
user@hostname:~/pagoda$ source virtualenv/bin/activate
(virtualenv) user@hostname:~/pagoda$ python manage.py runserver 0:8080
</code></pre><div class=gdoc-page__anchorwrap><h2 id=run-celery>Run Celery<a data-clipboard-text=https://dmm-com.github.io/pagoda/getting_started/development/#run-celery class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor Run Celery" href=#run-celery><svg class="icon link"><use xlink:href="#link"/></svg></a></h2></div><p>In addition, you have to run Celery worker to execute background task as following.</p><pre tabindex=0><code>user@hostname:~$ cd pagoda
user@hostname:~/pagoda$ source virtualenv/bin/activate
(virtualenv) user@hostname:~/pagoda$ celery -A airone worker -l info
</code></pre><div class=gdoc-page__anchorwrap><h2 id=build-the-new-ui-with-react>Build the new UI with React<a data-clipboard-text=https://dmm-com.github.io/pagoda/getting_started/development/#build-the-new-ui-with-react class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor Build the new UI with React" href=#build-the-new-ui-with-react><svg class="icon link"><use xlink:href="#link"/></svg></a></h2></div><p><code>/ui/</code> serves React-based new UI. Before you try it, you need to build <code>ui.js</code>:</p><p>Install nvm command.</p><p>Install npm packages.</p><pre tabindex=0><code>user@hostname:~$ nvm install 18.12.0
user@hostname:~$ cd pagoda
user@hostname:~/pagoda$ npm install
</code></pre><p>Build</p><pre tabindex=0><code>user@hostname:~/pagoda$ npm run build

(In development)
user@hostname:~/pagoda$ npm run watch
</code></pre><p>If you have any change on API V2, you need to run this command before you build:</p><pre tabindex=0><code>user@hostname:~/pagoda$ npm run generate:client

(For Customview)
user@hostname:~/pagoda$ npm run generate:custom_client
</code></pre><p>To customize UI:</p><pre tabindex=0><code>user@hostname:~/pagoda$ cp -pi ./frontend/src/App.tsx ./frontend/src/customview/CustomApp.tsx
(edit CustomApp.tsx)
user@hostname:~/pagoda$ npm run build:custom
</code></pre><div class=gdoc-page__anchorwrap><h3 id=api-v2-client>API V2 client<a data-clipboard-text=https://dmm-com.github.io/pagoda/getting_started/development/#api-v2-client class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor API V2 client" href=#api-v2-client><svg class="icon link"><use xlink:href="#link"/></svg></a></h3></div><p>Prepare to install API client npm package published on GitHub Packages.
<code>TOKEN</code> is a your GitHub PAT. Issue your PAT with checking <a href=https://docs.github.com/ja/packages/working-with-a-github-packages-registry/working-with-the-npm-registry#github-packages-%E3%81%B8%E3%81%AE%E8%AA%8D%E8%A8%BC%E3%82%92%E8%A1%8C%E3%81%86>this doc</a>.
Then, you just perform <code>npm install</code> as usual.</p><pre tabindex=0><code>$ cat &gt; .npmrc
//npm.pkg.github.com/:_authToken=TOKEN
</code></pre><p>You can refer your local API client code before publishing it to GitHub Packages with following command.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=c1># generate the latest API client code on your local env</span>
</span></span><span class=line><span class=cl>$ npm run generate:client
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># refer the latest code temporarily</span>
</span></span><span class=line><span class=cl>$ npm run link:client
</span></span></code></pre></div><p>If you modify something in API client code, you need to publish it with the package release GitHub Actions workflow. It will be triggered by labeling <code>release-apiv2-client</code> to the pull request by repository owners.</p><div class=gdoc-page__anchorwrap><h2 id=auto-format>Auto-format<a data-clipboard-text=https://dmm-com.github.io/pagoda/getting_started/development/#auto-format class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor Auto-format" href=#auto-format><svg class="icon link"><use xlink:href="#link"/></svg></a></h2></div><pre tabindex=0><code>user@hostname:~$ cd pagoda
user@hostname:~/pagoda$ source virtualenv/bin/activate
(virtualenv) user@hostname:~/pagoda$ ruff format .
(virtualenv) user@hostname:~/pagoda$ ruff check --fix .

user@hostname:~/pagoda$ npm run fix
</code></pre><div class=gdoc-page__anchorwrap><h2 id=test-for-django-processing>Test for Django processing<a data-clipboard-text=https://dmm-com.github.io/pagoda/getting_started/development/#test-for-django-processing class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor Test for Django processing" href=#test-for-django-processing><svg class="icon link"><use xlink:href="#link"/></svg></a></h2></div><p>You can run tests for processing that is run by Django and Celery, which means backend processing, as below.</p><pre tabindex=0><code>user@hostname:~$ cd pagoda
user@hostname:~/pagoda$ source virtualenv/bin/activate
(virtualenv) user@hostname:~/pagoda$ python manage.py test
</code></pre><p>When you want to run a specific test (<code>ModelTest.test_is_belonged_to_parent_group</code> in the file of <code>role/tests/test_model.py</code>) , you can do it as below.</p><pre tabindex=0><code>(virtualenv) user@hostname:~/pagoda$ python manage.py test role.tests.test_model.ModelTest.test_is_belonged_to_parent_group
</code></pre><div class=gdoc-page__anchorwrap><h2 id=test-for-react-processing>Test for React processing<a data-clipboard-text=https://dmm-com.github.io/pagoda/getting_started/development/#test-for-react-processing class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor Test for React processing" href=#test-for-react-processing><svg class="icon link"><use xlink:href="#link"/></svg></a></h2></div><p>You can run test for processing that is run by Browser, wihch means frontend processing as below.</p><pre tabindex=0><code>user@hostname:~$ cd pagoda
user@hostname:~/pagoda$ npm run test
</code></pre><p>If you have any change on a page component, please re-build snapshots along with current implementaion as below.</p><pre tabindex=0><code>user@hostname:~/pagoda$ npm run test:update
</code></pre><p>When you want to run individual test (e.g. frontend/src/components/user/UserList.test.tsx), you can do it by following command.</p><pre tabindex=0><code>user@hostname:~/pagoda$ npx jest -u frontend/src/components/user/UserList.test.tsx
</code></pre><div class=gdoc-page__anchorwrap><h2 id=release-pagoda-core-package-for-custom-views>Release pagoda-core package for custom views<a data-clipboard-text=https://dmm-com.github.io/pagoda/getting_started/development/#release-pagoda-core-package-for-custom-views class="gdoc-page__anchor gdoc-page__anchor--right clip" aria-label="Anchor Release pagoda-core package for custom views" href=#release-pagoda-core-package-for-custom-views><svg class="icon link"><use xlink:href="#link"/></svg></a></h2></div><p>We publish the <code>pagoda-core</code> package to GitHub npm Registry for custom views.
When you want to release a new version of the package, create a tag with the format <code>pagoda-core-x.y.z</code> (e.g. <code>pagoda-core-0.0.1</code>). The GitHub Actions workflow will automatically build and publish the package.</p><p>If you hope to try building the module:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ npm run build:lib
</span></span></code></pre></div></article><div class="gdoc-page__footer flex flex-wrap justify-between"></div></div></main><footer class=gdoc-footer><div class="container flex flex-wrap"><span class=gdoc-footer__item>Copyright Â© since 2020, DMM.com LLC. All Rights Reserved.</span></div></footer></div><script defer src=https://dmm-com.github.io/pagoda/js/en.search.min.bcbc78b2d3b43853cde6dece2ee3bcade37b4ae27bc87d423d14ae7f0c1495df.js></script>
<script defer src=https://dmm-com.github.io/pagoda/js/clipboard.min.js></script>
<script>document.addEventListener("DOMContentLoaded",function(){var t=new ClipboardJS(".clip")})</script></body></html>